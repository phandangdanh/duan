<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Debug Product Detail</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
    <div class="container mt-5">
        <h1 class="text-center mb-5">Debug Product Detail</h1>
        
        <div class="row">
            <div class="col-md-12">
                <div class="card">
                    <div class="card-header">
                        <h5>Debug Information</h5>
                    </div>
                    <div class="card-body">
                        <button class="btn btn-primary mb-3" onclick="debugProductDetail()">Debug Product Detail</button>
                        
                        <div id="debug-result" class="mt-3">
                            <p class="text-muted">Click button to debug...</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        async function debugProductDetail() {
            const resultDiv = document.getElementById('debug-result');
            resultDiv.innerHTML = '<p class="text-info">Debugging...</p>';
            
            try {
                console.log('=== DEBUGGING PRODUCT DETAIL ===');
                
                // Test API call
                const response = await fetch('http://localhost:8000/api/products/106', {
                    method: 'GET',
                    headers: {
                        'Accept': 'application/json',
                        'Content-Type': 'application/json'
                    }
                });
                
                console.log('API Response Status:', response.status);
                
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                
                const data = await response.json();
                console.log('API Response Data:', data);
                
                // Check HTML elements
                const titleElement = document.getElementById('product-title');
                const priceElement = document.getElementById('product-price');
                const descElement = document.getElementById('product-description');
                const thumbnailContainer = document.getElementById('thumbnail-gallery');
                
                console.log('HTML Elements:');
                console.log('- Title element:', titleElement);
                console.log('- Price element:', priceElement);
                console.log('- Description element:', descElement);
                console.log('- Thumbnail container:', thumbnailContainer);
                
                // Check if ProductDetailManager exists
                console.log('ProductDetailManager:', typeof productDetailManager);
                
                resultDiv.innerHTML = `
                    <div class="alert alert-success">
                        <h6>‚úÖ Debug Results</h6>
                        <p><strong>API Status:</strong> ${response.status}</p>
                        <p><strong>API Data:</strong> ${data.status_code === 200 ? 'Success' : 'Error'}</p>
                        <p><strong>Product Name:</strong> ${data.data?.tenSP || 'N/A'}</p>
                        <p><strong>Base Price:</strong> ${data.data?.base_price ? new Intl.NumberFormat('vi-VN').format(data.data.base_price) : 'N/A'} VNƒê</p>
                        <p><strong>Sale Price:</strong> ${data.data?.base_sale_price ? new Intl.NumberFormat('vi-VN').format(data.data.base_sale_price) : 'N/A'} VNƒê</p>
                        <p><strong>Images Count:</strong> ${data.data?.hinhanh?.length || 0}</p>
                        <p><strong>Variants Count:</strong> ${data.data?.chitietsanpham?.length || 0}</p>
                        <p><strong>ProductDetailManager:</strong> ${typeof productDetailManager !== 'undefined' ? 'Available' : 'Not Available'}</p>
                    </div>
                    
                    <div class="alert alert-info">
                        <h6>üîç HTML Elements Check</h6>
                        <p><strong>Title Element:</strong> ${titleElement ? 'Found' : 'Not Found'}</p>
                        <p><strong>Price Element:</strong> ${priceElement ? 'Found' : 'Not Found'}</p>
                        <p><strong>Description Element:</strong> ${descElement ? 'Found' : 'Not Found'}</p>
                        <p><strong>Thumbnail Container:</strong> ${thumbnailContainer ? 'Found' : 'Not Found'}</p>
                    </div>
                    
                    <div class="alert alert-warning">
                        <h6>üìã Next Steps</h6>
                        <p>1. Check console logs for detailed information</p>
                        <p>2. If API works but elements not found, check HTML structure</p>
                        <p>3. If ProductDetailManager not available, check JavaScript loading</p>
                        <p>4. Test the actual product detail page: <a href="http://localhost:8000/sanpham/106" target="_blank">http://localhost:8000/sanpham/106</a></p>
                    </div>
                `;
                
            } catch (error) {
                console.error('Debug Error:', error);
                resultDiv.innerHTML = `
                    <div class="alert alert-danger">
                        <h6>‚ùå Debug Error!</h6>
                        <p><strong>Error:</strong> ${error.message}</p>
                        <p><strong>Possible causes:</strong></p>
                        <ul>
                            <li>Laravel server not running (php artisan serve)</li>
                            <li>API endpoint not accessible</li>
                            <li>Product ID 106 not found</li>
                            <li>Network/CORS issues</li>
                        </ul>
                    </div>
                `;
            }
        }
        
        // Auto-debug on page load
        document.addEventListener('DOMContentLoaded', function() {
            console.log('Debug page loaded, ready to debug product detail');
        });
    </script>
</body>
</html>
